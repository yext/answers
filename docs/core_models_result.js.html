<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: core/models/result.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: core/models/result.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/** @module Result */

import AppliedHighlightedFields from './appliedhighlightedfields';
import HighlightedFields from './highlightedfields';
import { truncate } from '../utils/strings';
import { AnswersCoreError } from '../errors/errors';

export default class Result {
  constructor (data = {}) {
    /**
     * The raw profile data
     * @type {Object}
     * @private
     */
    this._raw = data.raw || null;

    /**
     * The formatted profile data
     * @type {Object}
     * @private
     */
    this._formatted = data.formatted;

    /**
     * The highlighted profile data with highlights applied to applicable fields
     * @type {Object}
     * @private
     */
    this._highlighted = data.highlighted;

    /**
     * An object that lists the substrings to highlight for each applicable field.
     * @type {Object}
     */
    this.highlightedFields = data.highlightedFields;

    /**
     * The index number of the result
     * @type {Number}
     */
    this.ordinal = data.ordinal || null;

    /**
     * The title of the result card
     * @type {string|null}
     */
    this.title = data.title || null;

    /**
     * The body of the details section of the result card, can contain HTML
     * @type {string| null}
     */
    this.details = data.details || null;

    /**
     * The destination link for the title of the result card
     * @type {string|null}
     */
    this.link = data.link || null;

    /**
     * The Entity ID, or other unique identifier, used for to power interactivity
     * @type {string|null}
     */
    this.id = data.id || null;

    /**
     * The subtitle on the result card
     * @type {string|null}
     */
    this.subtitle = data.subtitle || null;

    /**
     * The class modifier, usually derived from the vertical configuration ID
     * Used to apply different styling to different result card types
     * @type {string|null}
     */
    this.modifier = data.modifier || null;

    /**
     * A large date, of the format { month: 'Jan', day: '01' }
     * @type {Object|null}
     */
    this.bigDate = data.bigDate || null;

    /**
     * An image profile object, expected to have a url property
     * @type {Object|null}
     */
    this.image = data.image || null;

    /**
     * An array of calls to action, of the format:
     * { icon: '', url: '', text: '', eventType: '', eventOptions: {}}
     * @type {Array}
     */
    this.callsToAction = data.callsToAction || [];

    /**
     * Determines if an accordian result should be collapsed by default
     * @type {boolean}
     */
    this.collapsed = data.collapsed === undefined ? true : data.collapsed;

    /**
     * @type {number}
     */
    this.distance = data.distance || null;

    /**
     * @type {number}
     */
    this.distanceFromFilter = data.distanceFromFilter || null;
  }

  /**
   * Constructs an SDK Result from an answers-core Result
   *
   * @param {Result} result from answers-core
   * @param {Object&lt;string, function>} formatters applied to the result fields
   * @param {string} verticalKey the verticalKey associated with the result
   * @returns {@link Result}
   */
  static fromCore (result, formatters, verticalKey) {
    const highlightedFields = new HighlightedFields(result.highlightedFields);
    const appliedHighlightedFields = AppliedHighlightedFields.fromCore(result.highlightedFields);
    const details = appliedHighlightedFields.description || result.description;
    const truncatedDetails = truncate(details);

    const resultData = {
      raw: result.rawData,
      ordinal: result.index,
      title: result.name,
      details: truncatedDetails,
      link: result.link,
      id: result.id,
      distance: result.distance,
      distanceFromFilter: result.distanceFromFilter,
      highlighted: appliedHighlightedFields,
      highlightedFields
    };

    if (result.source !== 'KNOWLEDGE_MANAGER') {
      return new Result(resultData);
    }

    const formattedData = this._getFormattedData(resultData, formatters, verticalKey);
    resultData.formatted = formattedData;

    if (formattedData.description !== undefined) {
      resultData.details = formattedData.description;
    }

    return new Result(resultData);
  }

  /**
   * Returns an object which contains formatted fields
   *
   * @param {Object} resultData the same shape as the input to the Result constructor
   * @param {Object&lt;string, function>} formatters to apply to the result fields
   * @param {string} verticalKey the verticalKey associated with the result
   * @returns {Object&lt;string, string>} keys are field names and values are the formatted data
   */
  static _getFormattedData (resultData, formatters, verticalKey) {
    const formattedData = {};

    if (!formatters || !resultData.raw) {
      return formattedData;
    }

    if (Object.keys(formatters).length === 0) {
      return formattedData;
    }

    Object.entries(resultData.raw).forEach(([fieldName, fieldVal]) => {
      // check if a field formatter exists for the current entity profile field
      if (formatters[fieldName] === undefined) {
        return;
      }
      // verify the field formatter provided is a formatter function as expected
      if (typeof formatters[fieldName] !== 'function') {
        throw new AnswersCoreError('Field formatter is not of expected type function', 'Result');
      }

      // if highlighted version of field value is available, make it available to field formatter
      let highlightedFieldVal = null;
      if (resultData.highlighted &amp;&amp; resultData.highlighted[fieldName]) {
        highlightedFieldVal = resultData.highlighted[fieldName];
      }

      // call formatter function associated with the field name
      // the input object defines the interface that field formatter functions work with
      formattedData[fieldName] = formatters[fieldName]({
        entityProfileData: resultData.raw,
        entityFieldValue: fieldVal,
        highlightedEntityFieldValue: highlightedFieldVal,
        verticalId: verticalKey,
        isDirectAnswer: false
      });
    });

    return formattedData;
  }
}
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-AccordionCardComponent.html">AccordionCardComponent</a></li><li><a href="module-AccordionResultsComponent.html">AccordionResultsComponent</a></li><li><a href="module-AlternativeVerticals.html">AlternativeVerticals</a></li><li><a href="module-AlternativeVerticalsComponent.html">AlternativeVerticalsComponent</a></li><li><a href="module-AnalyticsReporter.html">AnalyticsReporter</a></li><li><a href="module-answers-umd.html">answers-umd</a></li><li><a href="module-ApiRequest.html">ApiRequest</a></li><li><a href="module-AppliedFiltersComponent.html">AppliedFiltersComponent</a></li><li><a href="module-AutoCompleteComponent.html">AutoCompleteComponent</a></li><li><a href="module-AutoCompleteData.html">AutoCompleteData</a></li><li><a href="module-CardComponent.html">CardComponent</a></li><li><a href="module-CombinedFilterNode.html">CombinedFilterNode</a></li><li><a href="module-Component.html">Component</a></li><li><a href="module-ComponentManager.html">ComponentManager</a></li><li><a href="module-Core.html">Core</a></li><li><a href="module-core_constants.html">core/constants</a></li><li><a href="module-core_index.html">core/index</a></li><li><a href="module-core_storage_storageindexes.html">core/storage/storageindexes</a></li><li><a href="module-CTACollectionComponent.html">CTACollectionComponent</a></li><li><a href="module-CTAComponent.html">CTAComponent</a></li><li><a href="module-DateFilterComponent.html">DateFilterComponent</a></li><li><a href="module-DefaultTemplatesLoader.html">DefaultTemplatesLoader</a></li><li><a href="module-DirectAnswer.html">DirectAnswer</a></li><li><a href="module-DirectAnswerComponent.html">DirectAnswerComponent</a></li><li><a href="module-DOM.html">DOM</a></li><li><a href="module-DynamicFilters.html">DynamicFilters</a></li><li><a href="module-ErrorReporter.html">ErrorReporter</a></li><li><a href="module-Errors.html">Errors</a></li><li><a href="module-EventEmitter.html">EventEmitter</a></li><li><a href="module-Facet.html">Facet</a></li><li><a href="module-FacetsComponent.html">FacetsComponent</a></li><li><a href="module-Filter.html">Filter</a></li><li><a href="module-FilterBoxComponent.html">FilterBoxComponent</a></li><li><a href="module-FilterCombinators.html">FilterCombinators</a></li><li><a href="module-FilterMetadata.html">FilterMetadata</a></li><li><a href="module-FilterNode.html">FilterNode</a></li><li><a href="module-FilterNodeFactory.html">FilterNodeFactory</a></li><li><a href="module-FilterOptionsComponent.html">FilterOptionsComponent</a></li><li><a href="module-FilterRegistry.html">FilterRegistry</a></li><li><a href="module-FilterSearchComponent.html">FilterSearchComponent</a></li><li><a href="module-FilterTypes.html">FilterTypes</a></li><li><a href="module-GeoLocationComponent.html">GeoLocationComponent</a></li><li><a href="module-GoogleMapProvider.html">GoogleMapProvider</a></li><li><a href="module-HandlebarsRenderer.html">HandlebarsRenderer</a></li><li><a href="module-HighlightedValue.html">HighlightedValue</a></li><li><a href="module-HttpRequester.html">HttpRequester</a></li><li><a href="module-IconComponent.html">IconComponent</a></li><li><a href="module-LegacyCardComponent.html">LegacyCardComponent</a></li><li><a href="module-LocationBias.html">LocationBias</a></li><li><a href="module-MapBoxMapProvider.html">MapBoxMapProvider</a></li><li><a href="module-MapComponent.html">MapComponent</a></li><li><a href="module-MapProvider.html">MapProvider</a></li><li><a href="module-ModuleData.html">ModuleData</a></li><li><a href="module-Navigation.html">Navigation</a></li><li><a href="module-NavigationComponent.html">NavigationComponent</a></li><li><a href="module-PaginationComponent.html">PaginationComponent</a></li><li><a href="module-QueryTriggers.html">QueryTriggers</a></li><li><a href="module-QuestionSubmission.html">QuestionSubmission</a></li><li><a href="module-QuestionSubmissionComponent.html">QuestionSubmissionComponent</a></li><li><a href="module-RangeFilterComponent.html">RangeFilterComponent</a></li><li><a href="module-Renderer.html">Renderer</a></li><li><a href="module-Result.html">Result</a></li><li><a href="module-ResultsContext.html">ResultsContext</a></li><li><a href="module-SearchComponent.html">SearchComponent</a></li><li><a href="module-SearchConfig.html">SearchConfig</a></li><li><a href="module-SearchDataTransformer.html">SearchDataTransformer</a></li><li><a href="module-SearchParams.html">SearchParams</a></li><li><a href="module-SearchParamsParser.html">SearchParamsParser</a></li><li><a href="module-SearchStates.html">SearchStates</a></li><li><a href="module-Section.html">Section</a></li><li><a href="module-SimpleFilterNode.html">SimpleFilterNode</a></li><li><a href="module-SortOptionsComponent.html">SortOptionsComponent</a></li><li><a href="module-SpellCheck.html">SpellCheck</a></li><li><a href="module-SpellCheckComponent.html">SpellCheckComponent</a></li><li><a href="module-StandardCardComponent.html">StandardCardComponent</a></li><li><a href="module-State.html">State</a></li><li><a href="module-StorageKeys.html">StorageKeys</a></li><li><a href="module-ui_components_componenttypes.html">ui/components/componenttypes</a></li><li><a href="module-ui_components_registry.html">ui/components/registry</a></li><li><a href="module-ui_index.html">ui/index</a></li><li><a href="module-ui_rendering_const.html">ui/rendering/const</a></li><li><a href="module-UniversalResults.html">UniversalResults</a></li><li><a href="module-UniversalResultsComponent.html">UniversalResultsComponent</a></li><li><a href="module-VerticalPagesConfig.html">VerticalPagesConfig</a></li><li><a href="module-VerticalResults.html">VerticalResults</a></li><li><a href="module-VerticalResultsComponent.html">VerticalResultsComponent</a></li></ul><h3>Namespaces</h3><ul><li><a href="module-DOM.html">DOM</a></li></ul><h3>Classes</h3><ul><li><a href="module.exports.html">exports</a></li><li><a href="module.exports_module.exports.html">exports</a></li><li><a href="module-AnalyticsReporter.html">AnalyticsReporter</a></li><li><a href="module-answers-umd-Answers.html">Answers</a></li><li><a href="module-ApiRequest.html">ApiRequest</a></li><li><a href="module-CombinedFilterNode.html">CombinedFilterNode</a></li><li><a href="module-Component.html">Component</a></li><li><a href="module-ComponentManager.html">ComponentManager</a></li><li><a href="module-Core.html">Core</a></li><li><a href="module-DateFilterComponent.html">DateFilterComponent</a></li><li><a href="module-DefaultTemplatesLoader.html">DefaultTemplatesLoader</a></li><li><a href="module-DynamicFilters.html">DynamicFilters</a></li><li><a href="module-ErrorReporter.html">ErrorReporter</a></li><li><a href="module-Errors.AnswersAnalyticsError.html">AnswersAnalyticsError</a></li><li><a href="module-Errors.AnswersBaseError.html">AnswersBaseError</a></li><li><a href="module-Errors.AnswersBasicError.html">AnswersBasicError</a></li><li><a href="module-Errors.AnswersComponentError.html">AnswersComponentError</a></li><li><a href="module-Errors.AnswersConfigError.html">AnswersConfigError</a></li><li><a href="module-Errors.AnswersCoreError.html">AnswersCoreError</a></li><li><a href="module-Errors.AnswersEndpointError.html">AnswersEndpointError</a></li><li><a href="module-Errors.AnswersStorageError.html">AnswersStorageError</a></li><li><a href="module-Errors.AnswersUiError.html">AnswersUiError</a></li><li><a href="module-EventEmitter.html">EventEmitter</a></li><li><a href="module-Facet.html">Facet</a></li><li><a href="module-FacetsComponent.html">FacetsComponent</a></li><li><a href="module-Filter.html">Filter</a></li><li><a href="module-FilterBoxComponent.html">FilterBoxComponent</a></li><li><a href="module-FilterMetadata.html">FilterMetadata</a></li><li><a href="module-FilterNode.html">FilterNode</a></li><li><a href="module-FilterNodeFactory.html">FilterNodeFactory</a></li><li><a href="module-FilterOptionsComponent.html">FilterOptionsComponent</a></li><li><a href="module-FilterRegistry.html">FilterRegistry</a></li><li><a href="module-FilterSearchComponent.html">FilterSearchComponent</a></li><li><a href="module-GeoLocationComponent.html">GeoLocationComponent</a></li><li><a href="module-GoogleMapProvider.html">GoogleMapProvider</a></li><li><a href="module-HandlebarsRenderer.html">HandlebarsRenderer</a></li><li><a href="module-HighlightedValue.html">HighlightedValue</a></li><li><a href="module-HttpRequester.html">HttpRequester</a></li><li><a href="module-IconComponent.html">IconComponent</a></li><li><a href="module-LegacyCardComponent.html">LegacyCardComponent</a></li><li><a href="module-LocationBias.html">LocationBias</a></li><li><a href="module-MapBoxMapProvider.html">MapBoxMapProvider</a></li><li><a href="module-MapProvider.html">MapProvider</a></li><li><a href="module-ModuleData.html">ModuleData</a></li><li><a href="module-NavigationComponent.html">NavigationComponent</a></li><li><a href="module-NavigationComponent.Tab.html">Tab</a></li><li><a href="module-QuestionSubmission.html">QuestionSubmission</a></li><li><a href="module-QuestionSubmissionComponent.html">QuestionSubmissionComponent</a></li><li><a href="module-Renderer.html">Renderer</a></li><li><a href="module-SearchComponent.html">SearchComponent</a></li><li><a href="module-SearchDataTransformer.html">SearchDataTransformer</a></li><li><a href="module-SearchParams.html">SearchParams</a></li><li><a href="module-SimpleFilterNode.html">SimpleFilterNode</a></li><li><a href="module-SortOptionsComponent.html">SortOptionsComponent</a></li><li><a href="module-SpellCheck.html">SpellCheck</a></li><li><a href="module-SpellCheckComponent.html">SpellCheckComponent</a></li><li><a href="module-StandardCardComponent.html">StandardCardComponent</a></li><li><a href="module-State.html">State</a></li><li><a href="RichTextFormatterImpl.html">RichTextFormatterImpl</a></li></ul><h3>Global</h3><ul><li><a href="global.html#_callListeners">_callListeners</a></li><li><a href="global.html#_generateArrayOneToN">_generateArrayOneToN</a></li><li><a href="global.html#_handleQueryUpdate">_handleQueryUpdate</a></li><li><a href="global.html#_selectPluralForm">_selectPluralForm</a></li><li><a href="global.html#addOptions">addOptions</a></li><li><a href="global.html#computeHighlightedDataRecursively">computeHighlightedDataRecursively</a></li><li><a href="global.html#convertNlpFiltersToFilterNodes">convertNlpFiltersToFilterNodes</a></li><li><a href="global.html#create">create</a></li><li><a href="global.html#defaultConfigOption">defaultConfigOption</a></li><li><a href="global.html#defaultTemplateName">defaultTemplateName</a></li><li><a href="global.html#delete">delete</a></li><li><a href="global.html#equivalentParams">equivalentParams</a></li><li><a href="global.html#filterIsPersisted">filterIsPersisted</a></li><li><a href="global.html#filterParamsForExperienceLink">filterParamsForExperienceLink</a></li><li><a href="global.html#findSimpleFiltersWithFieldId">findSimpleFiltersWithFieldId</a></li><li><a href="global.html#flag">flag</a></li><li><a href="global.html#flattenFilterNodes">flattenFilterNodes</a></li><li><a href="global.html#fromCore">fromCore</a></li><li><a href="global.html#fromData">fromData</a></li><li><a href="global.html#get">get</a></li><li><a href="global.html#getAll">getAll</a></li><li><a href="global.html#getAnalyticsUrl">getAnalyticsUrl</a></li><li><a href="global.html#getCachedLiveApiUrl">getCachedLiveApiUrl</a></li><li><a href="global.html#getContainerClass">getContainerClass</a></li><li><a href="global.html#getCurrentStateUrlMerged">getCurrentStateUrlMerged</a></li><li><a href="global.html#getKnowledgeApiUrl">getKnowledgeApiUrl</a></li><li><a href="global.html#getLiveApiUrl">getLiveApiUrl</a></li><li><a href="global.html#getPersistedRangeFilterContents">getPersistedRangeFilterContents</a></li><li><a href="global.html#getUrlParams">getUrlParams</a></li><li><a href="global.html#getUrlWithCurrentState">getUrlWithCurrentState</a></li><li><a href="global.html#groupArray">groupArray</a></li><li><a href="global.html#has">has</a></li><li><a href="global.html#init">init</a></li><li><a href="global.html#markup">markup</a></li><li><a href="global.html#Matcher">Matcher</a></li><li><a href="global.html#mergeTabOrder">mergeTabOrder</a></li><li><a href="global.html#nestValue">nestValue</a></li><li><a href="global.html#process">process</a></li><li><a href="global.html#pruneFilterNodes">pruneFilterNodes</a></li><li><a href="global.html#pushStateToHistory">pushStateToHistory</a></li><li><a href="global.html#registerListener">registerListener</a></li><li><a href="global.html#registerMiddleware">registerMiddleware</a></li><li><a href="global.html#removeListener">removeListener</a></li><li><a href="global.html#removeParamsWithPrefixes">removeParamsWithPrefixes</a></li><li><a href="global.html#replaceHistoryWithState">replaceHistoryWithState</a></li><li><a href="global.html#replaceUrlParams">replaceUrlParams</a></li><li><a href="global.html#report">report</a></li><li><a href="global.html#set">set</a></li><li><a href="global.html#setConversionTrackingEnabled">setConversionTrackingEnabled</a></li><li><a href="global.html#setWithPersist">setWithPersist</a></li><li><a href="global.html#toApiEvent">toApiEvent</a></li><li><a href="global.html#transformAutoCompleteResponse">transformAutoCompleteResponse</a></li><li><a href="global.html#transformFilterSearchResponse">transformFilterSearchResponse</a></li><li><a href="global.html#truncate">truncate</a></li><li><a href="global.html#urlWithoutQueryParamsAndHash">urlWithoutQueryParamsAndHash</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.6</a> on Thu May 27 2021 09:23:11 GMT-0400 (Eastern Daylight Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
